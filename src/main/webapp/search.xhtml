<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="WEB-INF/templates/default.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:f="http://java.sun.com/jsf/core"
				xmlns:p="http://primefaces.org/ui"
                xmlns:iudex="http://java.sun.com/jsf/composite/iudex">

    <f:metadata>
        <f:viewParam name="query" value="#{search.query}"/>
    </f:metadata>

    <ui:define name="content">
		<div class="container">
			<div class="panel">
				<form id="searchForm" method="get" action="#{request.contextPath}/search.xhtml" class="">
					<div id="searchBar">
						<div class="searchBar_left"></div>
						<div class="searchBar_inner"></div>
						<div class="searchBar_right"></div>
						<div class="searchBar_inner_left"></div>
						<div class="searchBar_inner_inner"></div>
						<div class="searchBar_inner_right"></div>
						<input type="text" name="query" value="#{search.query}" class="search-query"  label="Keyword" placeholder = "BUSCA UN PROFESOR O UNA MATERIA"/>
						<button id="searchButton" type="submit" />
					</div>
				</form>
			</div>
			<c:choose>
				<!--When the query is not null or empty-->
				<c:when test="#{!search.isQueryEmpty()}">
					<div class="panel">
						<h2>Reporte de resultados</h2>
						La consulta arrojo #{search.courses.size()} resultados para "#{search.query}".
						<hr size="5" noshade="noshade" />
						<c:choose>
							<!--When no data found-->
							<c:when test="#{search.isCoursesEmpty()}">
								No se encontraron resultados para "#{search.query}".
							</c:when>
							<!--When The query gets results Print them-->
							<c:otherwise>
								<table class="table">
									<tr>
										<th>Profesor</th>
										<th>Materia</th>
										<th>Promedio</th>
										<th>Seleccionar</th>
									</tr>
									<ui:repeat value="#{search.courses}" var="course" varStatus="loop">
										<tr>
											<td>#{course.professor.fullName}</td>
											<td>(#{course.subject.id}) #{course.subject.name}</td>
											<td>#{course.ratingAverage}</td>
											<td><a href="courses/view.xhtml?id=#{course.id}">Seleccionar</a></td>
										</tr>
									</ui:repeat>
								</table>
							</c:otherwise>
						</c:choose>
					</div>
				</c:when>
			</c:choose>
		</div>
    </ui:define>

</ui:composition>
